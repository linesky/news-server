' Gambas class file



Public Sub form_Close()
  
  Timer1.Enabled = False
  
End

Public Sub Form_Open()
Dim f1 As File
f1 = Open "/tmp/irc" For Create 
Close f1
f1 = Open "/tmp/irc.out" For Create 
Close f1
f1.Save("/tmp/irc", "")
f1.Save("/tmp/irc.out", "")
  TextArea1.Text = ""

End

Public Sub Button1_Click()
Dim f1 As File
Dim a As String 
Dim aa As String 
f1 = Open "/tmp/irc" For Create 
Close f1
If TextBox4.Text <> "" Then
  f1.Save("/tmp/irc", TextBox3.Text & ":" & TextBox4.Text & "\n")
Else
  f1.Save("/tmp/irc", "" & "\n")    
End If 
  Shell "netcat " & TextBox1.Text & " " & TextBox2.Text & " < /tmp/irc > /tmp/irc.out"
  Sleep 1
  f1 = Open "/tmp/irc.out" For Input
  aa = ""
  While 1
    Line Input #f1, a
    aa = aa & "\n" & a
    If Eof(f1) Then Break
  Wend
  Close #f1
  TextArea1.Text = aa
  TextArea1.refresh()
  Timer1.Enabled = True
End


Public Sub Timer1_Timer()
Dim f1 As File
Dim a As String 
Dim aa As String 
f1 = Open "/tmp/irc" For Create 
Close f1
  f1.Save("/tmp/irc", "" & "\n")    
  Shell "netcat " & TextBox1.Text & " " & TextBox2.Text & " < /tmp/irc > /tmp/irc.out"
  Sleep 1
  f1 = Open "/tmp/irc.out" For Input
  aa = ""
  While 1
    Line Input #f1, a
    aa = aa & "\n" & a
    If Eof(f1) Then Break
  Wend
  Close #f1
  TextArea1.Text = aa
  TextArea1.refresh()
  Timer1.Enabled = True
End
